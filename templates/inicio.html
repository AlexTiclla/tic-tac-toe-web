<!-- templates/index.html -->
<!-- templates/index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Binary Tree</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
</head>
<body>
    <h1 style="text-align: center;" >Interfaz de Usuario de Arboles</h1>
    <form method="POST">
        <input type="text" name="value" required>
        <button type="submit" name="action" value="insert">Insert</button>
        <button type="submit" name="action" value="delete">Delete</button>
    </form>
    <!-- Aquí puedes agregar código para visualizar el árbol binario -->
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <canvas id="treeCanvas" width="800" height="600"></canvas>

    <script>
        // Get the canvas element
        const canvas = document.getElementById('treeCanvas');
        const ctx = canvas.getContext('3d');

        // Define a function to draw a node
        function drawNode(x, y, value) {
            ctx.beginPath();
            ctx.arc(x, y, 20, 0, 2 * Math.PI);
            ctx.stroke();
            ctx.fillText(value, x - 5, y + 5);
        }

        // Define a function to draw the tree
        function drawTree(node, x, y, dx) {
            if (node !== null) {
                drawNode(x, y, node.value);
                if (node.left !== null) {
                    drawLine(x, y, x - dx, y + 100);
                    drawTree(node.left, x - dx, y + 100, dx / 2);
                }
                if (node.right !== null) {
                    drawLine(x, y, x + dx, y + 100);
                    drawTree(node.right, x + dx, y + 100, dx / 2);
                }
            }
        }
        
        // Define a function to visualize the insertion of a node
        function visualizeInsertion(value) {
            // Clear the canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        
            // Get the updated tree structure from the server and draw it
            fetch('/get_tree')
                .then(response => response.json())
                .then(tree => {
                    drawTree(tree, canvas.width / 2, 50, canvas.width / 4);
                });
        }

        // Define a function to send a POST request to the server
        function updateTree(action, value) {
            fetch('/update_tree', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ action, value }),
            })
            .then(response => response.json())
            .then(data => {
                console.log(data.message);
                visualizeInsertion(value);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
        
        // Draw a line between two nodes
        function drawLine(x1, y1, x2, y2) {
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
        }

        // Get the updated tree structure from the server and draw it
        fetch('/get_tree')
            .then(response => response.json())
            .then(tree => {
                drawTree(tree, canvas.width / 2, 50, canvas.width / 4);
            });
        
        const form = document.querySelector('form');
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            const action = form.elements.action.value;
            const value = form.elements.value.value;
            updateTree(action, value);
            visualizeInsertion(value);
        }); 
        
        drawNode(50, 50, 10); 



        
    </script>
</body>
</html>